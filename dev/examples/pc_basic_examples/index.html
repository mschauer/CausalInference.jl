<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PC Algorithm: Basic examples · CausalInference.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">CausalInference.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>PC Algorithm: Basic examples</a></li><li><a class="tocitem" href="../ges_basic_examples/">GES algorithm: Basic examples</a></li><li><a class="tocitem" href="../pc_cmi_examples/">PC Algorithm: Further examples</a></li><li><a class="tocitem" href="../pc_real_example/">PC Algorithm: Example using real data</a></li><li><a class="tocitem" href="../backdoor_example/">Reasoning about experiments (Backdoors and adjustments)</a></li></ul></li><li><a class="tocitem" href="../../library/">Library</a></li><li><a class="tocitem" href="../../comments/">Developer comments</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>PC Algorithm: Basic examples</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PC Algorithm: Basic examples</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/mschauer/CausalInference.jl/blob/master/docs/src/examples/pc_basic_examples.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="PC-Algorithm:-Basic-examples-1"><a class="docs-heading-anchor" href="#PC-Algorithm:-Basic-examples-1">PC Algorithm: Basic examples</a><a class="docs-heading-anchor-permalink" href="#PC-Algorithm:-Basic-examples-1" title="Permalink"></a></h1><p>A few example data sets can be useful to illustrate how to work with the PC algorithm and the different independence tests implemented in this package. The examples discussed here are based on the example models discussed in chapter 2 of Judea Pearl&#39;s book. The causal model we are going to study can be represented using the following DAG:</p><p><img src="https://raw.githubusercontent.com/mschauer/CausalInference.jl/master/assets/true_graph.png" alt="True example DAG"/></p><p>We can easily create some sample data that corresponds to the causal structure described by the DAG. For the sake of simplicity, let&#39;s create data from a simple linear model that follows the structure defined by the DAG shown above:</p><pre><code class="language-Julia">using CausalInference
using TikzGraphs
# If you have problems with TikzGraphs.jl, 
# try alternatively plotting backend GraphRecipes.jl + Plots.jl
# and corresponding plotting function `plot_pc_graph_recipes`

# Generate some sample data to use with the PC algorithm

N = 1000 # number of data points

# define simple linear model with added noise
x = randn(N)
v = x + randn(N)*0.25
w = x + randn(N)*0.25
z = v + w + randn(N)*0.25
s = z + randn(N)*0.25

df = (x=x, v=v, w=w, z=z, s=s)</code></pre><p>With this data ready, we can now see to what extent we can back out the underlying causal structure from the data using the PC algorithm. Under the hood, the PC algorithm uses repeated conditional independence tests to determine the causal relationships between different variables in a given data set. In order to run the PC algorithm on our test data set, we need to specify not only the data set we want to use, but also the conditional independence test alongside a p-value. For now, let&#39;s use a simple Gaussian conditional independence test with a p-value of 0.01. </p><pre><code class="language-Julia">est_g = pcalg(df, 0.01, gausscitest)</code></pre><p>In order to investigate the output of the PC algorithm, this package also provides a function to easily plot and visually analyse this output.</p><pre><code class="language-Julia">tp = plot_pc_graph_tikz(est_g, [String(k) for k in keys(df)])</code></pre><p><img src="https://raw.githubusercontent.com/mschauer/CausalInference.jl/master/assets/pc_graph_linear.png" alt="Example output of PC algorithm"/></p><p>The first thing that stands out in this plot is that only some edges have arrow marks, while others don&#39;t. For example, the edge going from <code>v</code> to <code>z</code> is pointing from <code>v</code> to <code>z</code>, indicating that that <code>v</code> influences <code>z</code> and not the other way around. On the other hand, the edge going from <code>x</code> to <code>w</code> has no arrows on either end, meaning that the direction of causal influence has not been identified and is in fact not identifiable based on the available data alone. Both causal directions, <code>x</code> influencing <code>v</code> and <code>v</code> influencing <code>x</code>, are compatible with the observed data. We can illustrate this directly by switching the direction of influence in the data generating process used above and running the PC algorithm for this new data set:</p><pre><code class="language-Julia"># Generate some additional sample data with different causal relationships

N = 1000 # number of data points

# define simple linear model with added noise
v = randn(N)
x = v + randn(N)*0.25
w = x + randn(N)*0.25
z = v + w + randn(N)*0.25
s = z + randn(N)*0.25

df = (x=x, v=v, w=w, z=z, s=s)

plot_pc_graph_tikz(pcalg(df, 0.01, gausscitest), [String(k) for k in keys(df)])
</code></pre><p><img src="https://raw.githubusercontent.com/mschauer/CausalInference.jl/master/assets/pc_graph_linear_xw_switched.png" alt="PC results for alternative DAG"/></p><p>We can, however, conclude unequivocally from the available (observational) data alone that <code>w</code> and <code>v</code> are causal for <code>z</code> and <code>z</code> for <code>s</code>. At no point did we have to resort to things like direct interventions, experiments or A/B tests to arrive at these conclusions!</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Home</a><a class="docs-footer-nextpage" href="../ges_basic_examples/">GES algorithm: Basic examples »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 31 July 2023 07:18">Monday 31 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
